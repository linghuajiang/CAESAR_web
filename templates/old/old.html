<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <link rel="shortcut icon" href="/static/images/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/static/images/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="HiRes project">
	<meta name="author" content="item084">
	<title>HiRes</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<link href="/static/css/index.css" rel="stylesheet">
	<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
		
	<!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<script src="https://vis.nucleome.org/static/lib/nb-dispatch.min.js"></script>
  </head>

  <body class="text-center">

    <!-- header -->
    <header>
      <div class="collapse bg-dark" id="navbarHeader">
        <div class="container">
          <div class="row">
            <div class="col-sm-8 col-md-7 py-4">
		      <h4 class="text-#ffffffdd">About</h4>
		      <p class="text-#ffffffdd text-left">Dr. Liu&rsquo;s research lab aims to develop machine learning approaches for real-world bioinformatics and medical informatics problems. We believe that computational methods are essential in order to understand many of these molecular biology problems, including the dynamics of genome conformation and nuclear organization, gene regulation, cellular networks, and the genetic basis of human diseases.</p>

		      <p class="text-#ffffffdd text-left">Liu Lab currently has openings for graduate students and postdocs. Please reach out to Dr. Jie Liu via email if you are interested.</p>
            </div>
            <div class="col-sm-3 offset-md-1 py-4">
              <h4 class="text-#ffffffdd">Contact</h4>
              <ul class="list-group">
			    <li class="list-group-item d-flex justify-content-between align-items-center">
				  <a href="https://jieliu6.github.io" target="_blank" class="contact label" style="color: black;">Home</a>
				  <a href="https://jieliu6.github.io" target="_blank" class="icon-home contact" style="color:black; font-size:14pt"></a></li>
			    <li class="list-group-item d-flex justify-content-between align-items-center">
				  <a href="mailto:drjieliu@umich.edu" target="_blank" class="contact label" style="color: black;">Email</a>
				  <a href="mailto:drjieliu@umich.edu" target="_blank" class="icon-envelope-alt contact" style="color: #b23121; font-size:14pt"></a></li>
			    <li class="list-group-item d-flex justify-content-between align-items-center">
				  <a href="https://github.com/jieliu6" target="_blank" class="contact label" style="color: black;">GitHub</a>
				  <a href="https://github.com/jieliu6" target="_blank" class="icon-github contact" style="font-size:14pt"></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="navbar navbar-dark bg-dark shadow-sm">
        <div class="container d-flex justify-content-between">
          <a href="#navbarHeader" class="navbar-brand d-flex align-items-center" data-toggle="collapse" data-target="#navbarHeader">
            <strong>Liu&nbsp;Lab&nbsp;&#124;&nbsp;HiRes&nbsp;Project</strong>
          </a>
          <button class="btn btn-outline-light" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
            <span>Contact us</span>
          </button>
        </div>
      </div>
	</header>

	<!-- panel -->
	<div class="container cont">
	  <div class="card panel mt-5 text-left">
		<!-- title -->  
		<div class="d-flex justify-content-center flex-column" style="text-align: center;">
		  <div>
			<h1 class="h3 font-weight-normal" >
			  Project Name 
			</h1>
		  </div>
		  <!-- learn more -->
		  <div class="d-flex justify-content-center flex-row">
		    <a data-toggle="collapse" href="#collapseExample" class="project title"
			   style="color: gray; font-size: 12px; margin-top: 4px; border-bottom: solid 1px #e4e4e4; width: fit-content">
		      &gt; Learn more &lt;
		    </a>
		  </div>
		  <div class="collapse" id="collapseExample">
		    <div class="card-body text-left">
			  We propose CAESAR, a deep learning model to predict nucleosome level chromatin contact maps from previously profiled epigenomic data such as chromatin accessibility and histone modifications. The model is also coupled with an attribution method which identifies the epigenomic features explanatory to these fine-scale chromatin structures.
			  <a href="#"> link</a>
		    </div>
		  </div>
	    </div>

	    <hr />

	    <!-- steps -->
	    <form action="/" method="post" enctype="multipart/form-data">
		  <!-- option -->
		  <label class="text-left" for="type" data-toggle="tooltip" data-placement="left" title="Visualize in Nucleome Browser">
			<strong>Step 1:</strong> Choose a tissue or cell line to visualize:
			<a data-toggle="modal" data-target="#step1help" href=""
				style="font-size: 14px; border-bottom: solid 1px #e4e4e4;">help</a>
		  </label>
		  <select class="form-control mb-3" name="type" id="type" onchange=change_view() required autofocus>
			<option value="default"></option>
			{% for dataset in datasets %}
				<option value="{{ dataset.name }}">{{ dataset.name }}</option>
			{% endfor %}
		  </select>
		  <a href="https://vis.nucleome.org/v1/main.html?config=https://nucleome.dcmb.med.umich.edu/config/demo.json" 
		     target="_blank" class="btn btn-outline-primary btn-block mb-3 disabled" id="view_btn" disabled>
		    View dataset
		  </a>
		  <!-- input -->
		  <label class="text-left" for="submit" data-toggle="tooltip" data-placement="left" title="e.g. chr7:100431453-100449162,chr7:100482501-100490325">
			<strong >Step 2:</strong> Choose a region from the visualized contact map:
			<a data-toggle="modal" data-target="#step2help" href=""
				style="font-size: 14px; border-bottom: solid 1px #e4e4e4;">help</a>
		  </label>
		  <div class="input-group mb-3">
 		    <div class="input-group-prepend">
    		  <span class="input-group-text">Region</span>
		    </div>
  		    <!-- input not required autofocus -->
		    <input type="text" name="region" id="region" class="form-control" autocomplete="off" placeholder="{{ region|e }}"
			       {% if entered %} value="{{ region|e }}" {% endif %} required >
		  </div>
      	  <!-- button onclick="submit_query()"-->
		  <button class="btn btn-outline-primary btn-block disabled" id="submit_btn" type="submit" disabled>Attribution</button>
	    </form>
	  
	    <hr />

	    <!-- progress bar -->
	    <label for="prog_out" class="text-left">Progress:</label>
	    <div id="prog_out" class="progress mb-3">
    	  <div id="prog_in" class="progress-bar bg-success" role="progressbar" style="width: 0%;">0%</div>
	    </div>
	    <div class="prog_line"></div>
	    <a href="https://vis.nucleome.org/v1/main.html?config=https://nucleome.dcmb.med.umich.edu/config/port{{ port|e }}.json" 
		   target="_blank" class="btn btn-outline-primary btn-block disabled" id="go_btn" type="submit" disabled>Go to result</a>
	    <!-- result area -->
	    <div class="form-group text-left" style="margin-top: 4pt;">
 		  <label for="resultArea" >Details:</label>
  		  <textarea class="form-control z-depth-1" id="resultArea" rows="3" placeholder="{{ result|e }}"></textarea>
	    </div>
	    <div class="d-flex justify-content-center">
  		  <div class="spinner-border text-success" role="status" id="spinner" style="visibility: hidden">
    		  <span class="sr-only">Loading...</span>
  		  </div>
	    </div>
			<!-- div class="container p-3 mb-3 border text-left">
				Link:
			</div -->
	  </div>
	  
	  <!-- toast -->
	  <div class="toast text-left" data-autohide="false">
    	<div class="toast-header mr-auto text-primary">
      	  Tip:
    	</div>
        <div class="toast-body">
    	  Please wait for the process bar to complete.<br>
      	  Avoid frequent resubmissions.
        </div>
  	  </div>
	</div>
	  

	<!-- copyright -->
	<p class="mt-5 text-muted"><!--&copy;-->Acknowledgment : <a href="https://vis.nucleome.org/" target="_blank"
	   style="color: gray; text-decoration: none; border-bottom: solid 1px #e4e4e4;">Nucleome Browser</a></p>
	<p class="mb-3 text-muted"><!--&copy;-->&copy; Liu Lab | University of Michigan | 2020</p>
		
	<!-- tutorial -->
	<div class="jumbotron">
  	  <h1 class="display-4">Tutorial</h1>
  	  <p class="lead">Step 1</p>
  	  <hr class="my-4">
  	  <!-- p>write something</p -->
  	  <a class="btn btn-primary btn-lg" target="_blank" href="/static/tutorial/tutorial.pdf" role="button">tutorial.pdf</a>
	</div>

	<!-- footer -->
	<footer class="blog-footer">
  	  <p>Template from <a class="navlink" href="https://getbootstrap.com/">Bootstrap</a> by <a class="navlink" href="https://twitter.com/mdo">@mdo</a>.</p>
  	  <p>
    	<a class="navlink" href="#">Back to top</a>
  	  </p>
	</footer>

	<!-- Modals -->
    <div class="modal fade bd-example-modal-xl" id="step1help" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
	    <div class="modal-content">
		  <div class="modal-header">
			<h5 class="modal-title" id="exampleModalCenterTitle">Step 1: </h5>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div class="modal-body">
			<!-- Slide -->
			<div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
				<ol class="carousel-indicators">
				  <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
				  <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
				  <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
				</ol>
				<div class="carousel-inner">
				  <div class="carousel-item active">
					<img src="/static/images/tutorial1.gif" class="d-block w-100" alt="...">
					<div class="carousel-caption d-none d-md-block" style="color: black; background-color: #ffffffdd;">
					  <h5>Step 1.A</h5>
					  <p>Select a tissue and click on the button to see its visualization in Nucleome Browser.</p>
					</div>
				  </div>
				  <div class="carousel-item">
					<img src="/static/images/tutorial2.gif" class="d-block w-100" alt="...">
					<div class="carousel-caption d-none d-md-block" style="color: black; background-color: #ffffffdd;">
					  <h5>Step 1.B</h5>
					  <p>Drag a region in Nucleom Browser and you can see its coordination in the top-left box.</p>
					</div>
				  </div>
				</div>
				<a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
				  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
				  <span class="sr-only">Previous</span>
				</a>
				<a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
				  <span class="carousel-control-next-icon" aria-hidden="true"></span>
				  <span class="sr-only">Next</span>
				</a>
			</div>
		  <!-- div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			<button type="button" class="btn btn-primary">Save changes</button>
		  </div -->
	      </div>
	    </div>
	  </div>
    </div>
    <div class="modal fade bd-example-modal-xl" id="step2help" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-dialog-centered" role="document">
		  <div class="modal-content">
			<div class="modal-header">
			  <h5 class="modal-title" id="exampleModalCenterTitle">Step 2: </h5>
			  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			  </button>
			</div>
			<div class="modal-body">
			  <!-- Slide -->
			  <div id="carouselExampleCaptions1" class="carousel slide" data-ride="carousel">
				  <ol class="carousel-indicators">
					<li data-target="#carouselExampleCaptions1" data-slide-to="0" class="active"></li>
					<li data-target="#carouselExampleCaptions1" data-slide-to="1"></li>
					<li data-target="#carouselExampleCaptions1" data-slide-to="2"></li>
				  </ol>
				  <div class="carousel-inner">
					<div class="carousel-item active">
					  <img src="/static/images/tutorial3.gif" class="d-block w-100" alt="...">
					  <div class="carousel-caption d-none d-md-block" style="color: black; background-color: #ffffffdd;">
						<h5>Step 2.A</h5>
						<p>Paste the region you copied from Nucleome Browser that you want to apply attribution calculation. Wait for the calculation to complete.</p>
					  </div>
					</div>
					<div class="carousel-item">
					  <img src="/static/images/tutorial4.gif" class="d-block w-100" alt="...">
					  <div class="carousel-caption d-none d-md-block" style="color: black; background-color: #ffffffdd;">
						<h5>Step 2.B</h5>
						<p>When it finishes, click on the button to see the results as tracks.</p>
					  </div>
					</div>
				  </div>
				  <a class="carousel-control-prev" href="#carouselExampleCaptions1" role="button" data-slide="prev">
					<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					<span class="sr-only">Previous</span>
				  </a>
				  <a class="carousel-control-next" href="#carouselExampleCaptions1" role="button" data-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true"></span>
					<span class="sr-only">Next</span>
				  </a>
			  </div>
			<!-- div class="modal-footer">
			  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			  <button type="button" class="btn btn-primary">Save changes</button>
			</div -->
			</div>
		  </div>
		</div>
	  </div>
	
	<!-- slide stop -->
	<script>
	  $('.carousel').carousel({
	    interval: false
	  })
	</script>

	<!-- tooltip init-->
	<script>
	  $(function () { $('[data-toggle="tooltip"]').tooltip() } )
	</script>
			
	<!-- toast init -->
	<script>
	  $(document).ready(function(){
		$('.toast').toast('show');
	  });
	</script>

	<!-- Progress -->
	<script>
	  $(document).ready(function(event){
		// event.preventDefault();
		{% if userid == "" %}
		  return;
		{% endif %}
		let source = new EventSource("/progress/{{userid}}");
		source.onmessage = function (event) {
		  let json = JSON.parse(event.data);
		  $("#go_btn").prop('class', 'btn btn-outline-primary btn-block disabled')
		  $("#go_btn").prop('disabled', true);
		  $("#submit_btn").prop('class', 'btn btn-outline-primary btn-block disabled')
		  $("#submit_btn").prop('disabled', true);
		  $("#spinner").css('visibility', 'visible');
		  $("#prog_in").css('width', json.prog + '%');
		  $("#prog_in").text(json.prog + '%');
		  $("#resultArea").prop('placeholder', json.msg);
		  if (json.prog == 100) {
			$("#spinner").css('visibility', 'hidden');
			$("#resultArea").text(json.result);
			$("#submit_btn").prop('class', 'btn btn-outline-primary btn-block')
			$("#go_btn").prop('class', 'btn btn-outline-primary btn-block')
			$("#submit_btn").prop('disabled', false);
			$("#go_btn").prop('disabled', false);
			source.close()
		  }
		  if (json.prog == 99) {
			$("#spinner").css('visibility', 'hidden');
			$("#resultArea").text(json.msg);
			$("#submit_btn").prop('class', 'btn btn-outline-primary btn-block')
			$("#submit_btn").prop('disabled', false);
			$("#go_btn").prop('disabled', false);
			source.close()
		  }
		}
	  });
	</script>

	<!-- Select option -->
	<script>
	  function change_view() {
		let opt = document.getElementById('type').value;
		if (opt === "default") {
		  console.log(opt);
		  $("#submit_btn").prop('class', 'btn btn-outline-primary btn-block disabled')
		  $("#view_btn").prop('class', 'btn btn-outline-primary btn-block mb-3 disabled')
		  $("#submit_btn").prop('disabled', true);
		  $("#view_btn").prop('disabled', true);
		  $("#view_btn").target = "_self";
		} else {
		  //$("#view_btn").classList.remove("disabled");
		  //$("#submit_btn").classList.remove("disabled");
		  $("#submit_btn").prop('class', 'btn btn-outline-primary btn-block')
		  $("#view_btn").prop('class', 'btn btn-outline-primary mb-3 btn-block')
		  $("#submit_btn").prop('disabled', false);
		  $("#view_btn").prop('disabled', false);
		  $("#view_btn").target = "_blank"
	    }
		if (opt === "Pancreas") {
		  console.log(opt);
		  target.href = "https://vis.nucleome.org/v1/main.html?config=https://nucleome.dcmb.med.umich.edu/config/demo.json"
		}
	  }
	</script>
			
	<div id="connection"></div>
	<!-- Bridge -->
	<script>
	  (function() {
		let chan = nb.dispatch("update","brush")
		chan.connect(function(d){
		  document.getElementById("connection").innerHTML = d.connection
		})
		// document.getElementById("btn").onclick = function(e){
		//   chan.call("update",this,[{chr:"chr2",start:10000,end:50000}])                    
		// }                        
		// chan.on("update",function(d){
		  // document.getElementById("message").innerHTML = JSON.stringify(d)
		// })
		chan.on("brush",function(d){
		  let temp1 = d[0]["chr"] + ":" + d[0]["start"] + "-" + d[0]["end"];
		  let temp2 = d[1]["chr"] + ":" + d[1]["start"] + "-" + d[1]["end"];
		  document.getElementById("region").value = temp1 + "," + temp2;
		})
	  })()
	</script>
			
  </body>
</html>